<!DOCTYPE html> 
<html>
<head>
  <title>Offline To-Do Matrix</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      margin: 0;
      padding: 10px;
      box-sizing: border-box;
      background: #f5f5f5;
    }

    /* Login row */
    #loginRow {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      background: white;
      padding: 8px 12px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #userDisplay {
      font-weight: bold;
      color: #333;
    }
    #loginBtn {
      padding: 6px 14px;
      border: none;
      border-radius: 12px;
      background: #007bff;
      color: white;
      cursor: pointer;
      transition: 0.2s;
    }
    #loginBtn:hover {
      background: #0056b3;
    }

    /* Stacked form */
    form {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 15px;
      width: 220px;
      background: white;
      padding: 12px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    form input, form select, form button {
      padding: 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    form button {
      background: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      transition: 0.2s;
    }
    form button:hover {
      background: #1e7e34;
    }

    /* Matrix grid */
    #matrix {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: 12px;
    }
    .box {
      border-radius: 12px;
      padding: 10px;
      overflow-y: auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .important.urgent { background: #f99; }
    .important.not-urgent { background: #ff9; }
    .not-important.urgent { background: #9f9; }
    .not-important.not-urgent { background: #99f; color: white; }

    ul { padding: 0; list-style: none; }
    li { margin: 5px 0; cursor: pointer; }
    li:hover { text-decoration: line-through; }
  </style>
</head>
<body>

<!-- Login row -->
<div id="loginRow">
  <span id="userDisplay">Not logged in</span>
  <button id="loginBtn">Log In</button>
</div>

<!-- Add task form -->
<form id="taskForm">
  <input type="text" id="taskInput" placeholder="New task" required>
  <select id="taskCat">
    <option value="iu">Important + Urgent</option>
    <option value="inu">Important + Not Urgent</option>
    <option value="niu">Not Important + Urgent</option>
    <option value="ninu">Not Important + Not Urgent</option>
  </select>
  <button type="submit">Add Task</button>
</form>

<!-- Matrix -->
<div id="matrix">
  <div class="box important urgent"><h3>Important + Urgent</h3><ul id="iu"></ul></div>
  <div class="box important not-urgent"><h3>Important + Not Urgent</h3><ul id="inu"></ul></div>
  <div class="box not-important urgent"><h3>Not Important + Urgent</h3><ul id="niu"></ul></div>
  <div class="box not-important not-urgent"><h3>Not Important + Not Urgent</h3><ul id="ninu"></ul></div>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let user = localStorage.getItem("user") || null;

function render() {
  ["iu","inu","niu","ninu"].forEach(id => {
    const ul = document.getElementById(id);
    ul.innerHTML = "";
    tasks.filter(t => t.cat === id).forEach(t => {
      const li = document.createElement("li");
      li.textContent = t.text;
      li.onclick = () => { tasks.splice(tasks.indexOf(t),1); save(); };
      ul.appendChild(li);
    });
  });
  renderUser();
}

function save() {
  localStorage.setItem("tasks", JSON.stringify(tasks));
  render();
}

function renderUser() {
  const display = document.getElementById("userDisplay");
  const btn = document.getElementById("loginBtn");
  if (user) {
    display.textContent = "Logged in as: " + user;
    btn.textContent = "Log Out";
  } else {
    display.textContent = "Not logged in";
    btn.textContent = "Log In";
  }
}

// Handle add task
document.getElementById("taskForm").addEventListener("submit", e => {
  e.preventDefault();
  if (!user) {
    alert("Please log in first!");
    return;
  }
  const text = document.getElementById("taskInput").value.trim();
  const cat = document.getElementById("taskCat").value;
  if(text) {
    tasks.push({text, cat});
    save();
    document.getElementById("taskInput").value = "";
  }
});

// Handle login/logout
document.getElementById("loginBtn").addEventListener("click", () => {
  if (user) {
    user = null;
    localStorage.removeItem("user");
  } else {
    const name = prompt("Enter your name:");
    if (name) {
      user = name;
      localStorage.setItem("user", user);
    }
  }
  renderUser();
});

render();
</script>
</body>
</html>
